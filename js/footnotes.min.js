"use strict";dotclear.ready(()=>{const t=dotclear.getData("flightnotes"),e=".post-content",o=/^#(fn|footnote|wiki-footnote)[:\-_\d]/gi,s=/^#(fnref|footnote-marker|rev-wiki-footnote)[:\-_\d]/gi,n=Array.from(document.querySelectorAll(`${e} a`)).filter(t=>t.href.startsWith(document.location.href)&&t.hash.match(o)&&!t.hash.match(s));if(n.length>0){const o=document.querySelector(`${e} .footnotes`);if(o){const e=o.cloneNode(!0);for(const t of e.children)("HR"===t.tagName||t.tagName.match(/H[1-6]/)||"HEADER"===t.tagName)&&t.remove();if(t?.background){const t=function(){const t=document.createElement("div");document.head.appendChild(t);const e=window.getComputedStyle(t).backgroundColor;return document.head.removeChild(t),e},s=function(e){const o=t(),n=window.getComputedStyle(e).backgroundColor;return n!==o?n:e.parentElement?s(e.parentElement):o};e.style.backgroundColor=s(o)}e.classList.add("flightnotes"),o.classList.add("cloned"),o.after(e);const s=(t,o)=>{for(const o of t){const t=o.target.getAttribute("href").replace(/^.*#/,"");let s=e.querySelector(`.flightnotes #${CSS.escape(t)}`);"A"===s.tagName&&(s=s.parentNode),o.isIntersecting?(s.classList.add("flightnotes_note_show"),s.classList.remove("flightnotes_note_hide")):(s.classList.add("flightnotes_note_hide"),s.classList.remove("flightnotes_note_show"))}e.querySelectorAll(".flightnotes_note_show").length>0?e.classList.add("flightnotes_show"):e.classList.remove("flightnotes_show")},r=new IntersectionObserver(s,{threshold:[1],trackVisibility:!0,delay:100});for(const t of n)r.observe(t);const c=(t,o)=>{for(const o of t)o.isIntersecting?e.classList.add("flightnotes_hide"):e.classList.remove("flightnotes_hide")},i=new IntersectionObserver(c);i.observe(o)}}});
