"use strict";dotclear.ready(()=>{const e=".post-content",t=/^#(fn|footnote|wiki-footnote)[:\-_\d]/gi,o=/^#(fnref|footnote-marker|rev-wiki-footnote)[:\-_\d]/gi,n=Array.from(document.querySelectorAll(`${e} a`)).filter(e=>e.href.startsWith(document.location.href)&&e.hash.match(t)&&!e.hash.match(o));if(n.length>0){const t=document.querySelector(`${e} .footnotes`);if(t){const o=t.cloneNode(!0);for(const e of o.children)("HR"===e.tagName||e.tagName.match(/H[1-6]/))&&e.remove();o.classList.add("notebox"),t.classList.add("cloned"),t.after(o);const s=function(e){const t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}},c=function(t){const n=s(t),c=s(document.querySelector(`${e} .footnotes.cloned`)),r=t.getAttribute("href").replace(/^.*#/,"");let i=o.querySelector(`.notebox #${CSS.escape(r)}`);"A"===i.tagName&&(i=i.parentNode);const d=window.innerHeight/1.5,l=window.innerHeight/10,a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;n&&a>n.top-d&&a<n.top-l&&a<c.top-d?(i.classList.add("show_note"),i.classList.remove("hide_note")):(i.classList.add("hide_note"),i.classList.remove("show_note"))},r=function(){for(const e of n)c(e);o.querySelectorAll(".show_note").length>0?o.classList.add("present"):o.classList.remove("present")};r(),window.addEventListener("scroll",r()),window.addEventListener("resize",r()),setTimeout(()=>{},5e3)}}});
