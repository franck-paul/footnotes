"use strict";dotclear.ready(()=>{const e=dotclear.getData("flightnotes"),t=".post-content",o=/^#(fn|footnote|wiki-footnote)[:\-_\d]/gi,s=/^#(fnref|footnote-marker|rev-wiki-footnote)[:\-_\d]/gi,n=Array.from(document.querySelectorAll(`${t} a`)).filter(e=>e.href.startsWith(document.location.href)&&e.hash.match(o)&&!e.hash.match(s));if(n.length>0){const o=document.querySelector(`${t} .footnotes`);if(o){const t=o.cloneNode(!0);for(const e of t.children)("HR"===e.tagName||e.tagName.match(/H[1-6]/)||"HEADER"===e.tagName)&&e.remove();if(e?.background){const e=()=>{const e=document.createElement("div");document.head.appendChild(e);const t=globalThis.getComputedStyle(e).backgroundColor;return e.remove(),t},s=t=>{const o=e(),{backgroundColor:n}=globalThis.getComputedStyle(t);return n!==o?n:t.parentElement?s(t.parentElement):o};t.style.backgroundColor=s(o)}t.classList.add("flightnotes"),o.classList.add("cloned"),o.after(t);const s=(e,o)=>{for(const o of e){const e=o.target.getAttribute("href").replace(/^.*#/,"");let s=t.querySelector(`.flightnotes #${CSS.escape(e)}`);"A"===s.tagName&&(s=s.parentNode),o.isIntersecting?(s.classList.add("flightnotes_note_show"),s.classList.remove("flightnotes_note_hide")):(s.classList.add("flightnotes_note_hide"),s.classList.remove("flightnotes_note_show"))}t.querySelectorAll(".flightnotes_note_show").length>0?t.classList.add("flightnotes_show"):t.classList.remove("flightnotes_show")},r=new IntersectionObserver(s,{threshold:[1],trackVisibility:!0,delay:100});for(const e of n)r.observe(e);const l=(e,o)=>{for(const o of e)o.isIntersecting?t.classList.add("flightnotes_hide"):t.classList.remove("flightnotes_hide")},a=new IntersectionObserver(l);a.observe(o)}}});
